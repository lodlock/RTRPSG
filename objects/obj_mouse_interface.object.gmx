<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_Mouse</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Init The Mouse Interface
/*
Features
    Contectual
        Different Actions Based on The Object The Mouse is over
        over_gui, over_peep, over_land, over_item;
    Controls
        Left Press : Select\Deselect Object
        Left Press Move: Drag Select \ Pickup
        Left Release : Drop
        Right Press : Command - Trade, Attack, Move, Interact
            based on the over_ variables
    Shift: Select Multi
*/

//variables used for drag selecting
global.start_x = -4
global.start_y = -4
global.end_x = -4
global.end_y = -4
global.select_multi=false;
global.selected_object = noone;
global.follow_object = noone
global.item = -1;
clicked=false;

//interface_variables
over_gui = false;
over_peep = false;
over_item = false;
over_tool = false;
over_resource = false;
over_npc = false;

image_speed = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Set My Location
x=mouse_x;
y=mouse_y;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///What is My Interface Object

if ( position_meeting( mouse_x, mouse_y, obj_player_peep ) ) {
    over_peep=true;
    image_index = 0
} else if ( position_meeting( mouse_x, mouse_y, obj_npc_peep ) ) {
    over_npc=true;
    image_index = 2     
} else if ( position_meeting( mouse_x, mouse_y, obj_gui ) ) {
    over_gui=true;
    image_index = 0
} else if ( position_meeting( mouse_x, mouse_y, obj_item ) ) {
    over_item=true;
    image_index = 4
} else if ( position_meeting( mouse_x, mouse_y, obj_resource ) ) {
    over_resource=true;
    image_index = 1
} else if ( position_meeting( mouse_x, mouse_y, obj_tool ) ) {
    over_tool=true;
    image_index = 3
} else {
    over_gui = false;
    over_peep = false;
    over_item = false;
    over_tool = false;
    over_resource = false;
    over_npc = false;
    image_index = 0
}


//Create the rest of the select box...
if ( clicked == true ) {
    global.end_x = mouse_x;
    global.end_y = mouse_y;

    if ( point_distance( global.start_x,global.start_y,global.end_x,global.end_y ) &gt;= 16 ) {
        global.select_multi=true;
    }
    else {
        global.select_multi=false;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="56">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Turn it all off

global.start_x = -4
global.start_y = -4
global.end_x = -4
global.end_y = -4
global.select_multi=false;
clicked=false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="54">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///DO stuff!

//Assign a move target to a peep
if ( !over_gui &amp;&amp; !over_item &amp;&amp; !over_resource &amp;&amp; !over_tool &amp;&amp; !over_peep &amp;&amp; !over_npc ) {
    with ( obj_player_peep ) {
        if ( selected = true ) {
            if ( target = noone ) {
                target = instance_create(mouse_x, mouse_y, obj_goto);
                state = 'move';
            } else {
                if ( instance_exists( target ) ) {
                    if ( object_get_name(target.object_index) = 'obj_goto' ) {
                        with ( target ) { 
                            instance_destroy();
                        }
                    }
                    target = instance_create(mouse_x, mouse_y, obj_goto);
                    state = 'move'; 
                }           
            }
        }
    }
}
//Assign a item terget to a peep... right now just moves to it and picks it up... needs a special state and script?
if ( over_item ) {
    var check;
    check = instance_position(mouse_x, mouse_y, obj_item);
    with ( obj_player_peep ) {
        if ( selected = true ) {
            if ( target = noone ) {    
                target = check;
                state = 'move';
            } else {
                if ( instance_exists( target ) ) {
                    if ( object_get_name(target.object_index) = 'obj_goto' ) {
                        with ( target ) { 
                            instance_destroy();
                        }
                    }
                    target = check;
                    state = 'move';
                }
            }
        }
    }
}

//Assign aresource terget to a peep.. basic... needs a special state and script?
if ( over_resource ) {
    var check;
    check = instance_position(mouse_x, mouse_y, obj_resource);
    with ( obj_player_peep ) {
        if ( selected = true ) {
            if ( target = noone ) {    
                    target = check;
                    state = 'move';
            } else {
                if ( instance_exists( target ) ) {
                    if ( object_get_name(target.object_index) = 'obj_goto' ) {
                        with ( target ) { 
                            instance_destroy();
                        }
                    }
                    target = check;
                    state = 'move';
                }
            }
        }
    }
}

//Assign aresource terget to a peep.. basic... needs a special state and script?
if ( over_tool ) {
    var check;
    check = instance_position(mouse_x, mouse_y, obj_resource);
    with ( obj_player_peep ) {
        if ( selected = true ) {
            if ( target = noone ) {    
                    target = check;
                    state = 'move';
            } else {
                if ( instance_exists( target ) ) {
                    if ( object_get_name(target.object_index) = 'obj_goto' ) {
                        with ( target ) { 
                            instance_destroy();
                        }
                    }
                    target = check;
                    state = 'move';
                }
            }
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="53">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Set Start X and Y, Do Click...
global.start_x = mouse_x;
global.start_y = mouse_y;
clicked=true;

//Based on what my mouse is hovering over... do something specific
if ( over_peep ) {
    var check;
    check = instance_position( mouse_x, mouse_y, obj_player_peep );
    if ( check != noone ) {
        if ( !check.selected ) {
            if ( !keyboard_check( vk_shift ) ) {
                with ( obj_player_peep ) {
                    selected = false;
                    superselected = false;
                    global.selected_object = noone;
                }
            }
            with ( check ) {
                selected = true;
                superselected = true;
                global.selected_object = check;
            }
        } else {
            global.follow_object = check;
            global.selected_object = check;
        }
    }
}
else {
    //Left clicked on the ground, deselects everything... only works here if not holding an item.
    if ( !over_gui &amp;&amp; !over_item &amp;&amp; !over_resource &amp;&amp; !over_tool &amp;&amp; !over_peep &amp;&amp; !over_npc &amp;&amp; global.item = -1 ) {
        if ( !keyboard_check( vk_shift ) ) {
            with ( obj_player_peep ) {
                selected = false;
                superselected = false;
                global.selected_object = noone;
            }
        }
    }
}

if ( over_npc ) {
    var check;
    check = instance_position( mouse_x, mouse_y, obj_npc_peep );
    if ( check != noone ) {
        if ( !check.selected ) {
            //just to be sure, de-select every other peep
            with ( obj_npc_peep ) {
                selected = false;
            }
            check.selected = true;
        } else {
            //global.selected_object = check; //Need to find a way to rep NPCs
        }
    }
}
// dont know if I need this here...
else {
    if ( !over_gui &amp;&amp; !over_item &amp;&amp; !over_resource &amp;&amp; !over_tool &amp;&amp; !over_peep ) {
        if ( !keyboard_check( vk_shift ) ) {            
            with ( obj_npc_peep ) {
                selected = false;
            }
        }
    }
}
//if holding an item, Drop the item next to peep
if ( !over_gui &amp;&amp; !over_item &amp;&amp; !over_resource &amp;&amp; !over_tool &amp;&amp; !over_peep &amp;&amp; !over_npc &amp;&amp; global.item != -1 ) {
    if ( global.selected_object != noone &amp;&amp; global.item != -1 ) {
        if ( mouse_x &lt; global.selected_object.x ) { var dirx = -32 } else { dirx = 32 }
        if ( mouse_y &lt; global.selected_object.y ) { var diry = -32 } else { diry = 32 }
            instance_create( global.selected_object.x + dirx, global.selected_object.y + diry, global.item );
        global.item = -1;   
    }
}

/*
if ( over_item ) {
    var check;
    check = instance_position(mouse_x, mouse_y, obj_item);

    if ( global.item = -1 ) {
        global.item = check.object_index;
        with (check) {
            instance_destroy();
        }
    } else {
        instance_create(mouse_x,mouse_y,global.item);
        global.item = check.object_index;
        with (check) {
            instance_destroy();
        }
    }
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_set_color(c_white);

draw_text(0,32,"Clicked = " + string(clicked));

draw_text(0,64,"Selecting = " + string(global.select_multi));

draw_text(0,128,"View = " + string( view_wview[0]));

tempText = "Instances = " + string(instance_count) + " FPS = " + string(fps_real);
    
draw_set_color(c_black);

draw_rectangle(0,0,string_width(tempText), 0 + string_height(tempText), false);

//draw_text(0,160,string(global.item));

draw_text(0,192,string(over_item));
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw Selection Box

if ( global.select_multi == true ) {
    draw_set_color(make_color_rgb(128, 128, 128));
    draw_set_alpha(1);
    draw_rectangle(global.start_x, global.start_y, global.end_x, global.end_y, true);
    draw_set_alpha(0.1);
    draw_rectangle(global.start_x, global.start_y, global.end_x, global.end_y, false);
    draw_set_alpha(1);   
}

///Draw the held Item

if (global.item != -1 ) {
    draw_sprite( object_get_sprite(global.item), 0, mouse_x, mouse_y )   
}

draw_self();
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
